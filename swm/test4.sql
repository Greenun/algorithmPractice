SELECT STAGE, ROUND(AVG(STUDENT_NUM)) AS STD, TRUNCATE(SUM(STUDENT_NUM) / SUM(TEACHER_NUM), 1) AS TCR FROM SCHOOLS GROUP BY STAGE ORDER BY STD DESC, TCR ASC;